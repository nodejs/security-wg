{
  "id": 94,
  "created_at": "2016-03-28",
  "updated_at": "2016-05-13",
  "title": "Non-Constant Time String Comparison",
  "author": {
    "name": "Todd Wolfson",
    "website": null,
    "username": null
  },
  "module_name": "csrf-lite",
  "publish_date": "2016-04-23",
  "cves": [],
  "vulnerable_versions": "<=0.1.1",
  "patched_versions": ">=0.1.2",
  "overview": "- csrf-lite is a cross-site request forgery protection library for framework-less node sites    - csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison    - This enables an attacker being able to calculate minuscule differences in CSRF tokens, essentially enabling them to guess the token one character at a time            _Example psuedo-code of how the built-in string comparison (fail first) works_:    ```    function compareTokens(a, b)        tempCheck = 0;        if a.length() != b.length()            return false;        for each character in a {            tempCheck += 1;            if a[current character check] != b[current character check]                return false;        }        return true;        csrfToken = 63737266546f6b656e;    csrfTokenCompare = user_input();        compareTokens(csrfToken, csrfTokenCompare);    ```    Each check increases the variable `tempCheck` by one. If a malicious user is able to see what `tempCheck` is at each run (how long it takes to do a check), then they can see when it increases. This increase indicates that the character they just put in for `csrfTokenCompare` is the correct one.",
  "recommendation": "Update to at least version 0.1.2",
  "references": [
    "https://github.com/isaacs/csrf-lite/pull/1"
  ],
  "cvss_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
  "cvss_score": 4.3,
  "coordinating_vendor": "^Lift Security"
}
